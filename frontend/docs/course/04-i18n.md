# Vid√©o 04 - Internationalisation (i18n)

## üé¨ Dur√©e: 10 minutes

---

## üìã Script Vid√©o D√©taill√©

### ‚è±Ô∏è 0:00 - 2:00 | Structure des Fichiers de Traduction (2 min)

**√Ä dire:**
> "L'internationalisation - ou i18n - permet d'avoir votre app en plusieurs langues. On va supporter Anglais, Fran√ßais et Espagnol."

**Structure √† cr√©er:**
```
i18n/
‚îú‚îÄ‚îÄ index.tsx              # Provider et hook useTranslation
‚îî‚îÄ‚îÄ translations/
    ‚îú‚îÄ‚îÄ en.json            # üá¨üáß Anglais (d√©faut)
    ‚îú‚îÄ‚îÄ fr.json            # üá´üá∑ Fran√ßais
    ‚îî‚îÄ‚îÄ es.json            # üá™üá∏ Espagnol
```

**Cr√©er le fichier de traduction anglais:**
```json
// i18n/translations/en.json
{
  "common": {
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete",
    "edit": "Edit",
    "add": "Add",
    "search": "Search..."
  },
  "nav": {
    "dashboard": "Dashboard",
    "workers": "Workers",
    "revenues": "Revenues",
    "expenses": "Expenses",
    "settings": "Settings"
  },
  "dashboard": {
    "title": "Dashboard",
    "totalRevenue": "Total Revenue",
    "totalExpenses": "Total Expenses",
    "netIncome": "Net Income",
    "activeWorkers": "Active Workers",
    "todaysSessions": "Today's Sessions",
    "topPerformers": "Top Performers"
  },
  "settings": {
    "title": "Settings",
    "theme": "Theme",
    "language": "Language",
    "darkMode": "Dark Mode",
    "accentColor": "Accent Color"
  }
}
```

**Cr√©er le fichier fran√ßais:**
```json
// i18n/translations/fr.json
{
  "common": {
    "save": "Enregistrer",
    "cancel": "Annuler",
    "delete": "Supprimer",
    "edit": "Modifier",
    "add": "Ajouter",
    "search": "Rechercher..."
  },
  "nav": {
    "dashboard": "Tableau de bord",
    "workers": "Travailleurs",
    "revenues": "Revenus",
    "expenses": "D√©penses",
    "settings": "Param√®tres"
  },
  "dashboard": {
    "title": "Tableau de bord",
    "totalRevenue": "Revenu Total",
    "totalExpenses": "D√©penses Totales",
    "netIncome": "B√©n√©fice Net",
    "activeWorkers": "Travailleurs Actifs",
    "todaysSessions": "Sessions du Jour",
    "topPerformers": "Meilleurs Performers"
  },
  "settings": {
    "title": "Param√®tres",
    "theme": "Th√®me",
    "language": "Langue",
    "darkMode": "Mode Sombre",
    "accentColor": "Couleur d'Accent"
  }
}
```

**√Ä dire:**
> "On organise les traductions par section: common pour les mots g√©n√©riques, nav pour la navigation, dashboard pour le tableau de bord, etc."

---

### ‚è±Ô∏è 2:00 - 5:00 | Cr√©er le Provider i18n (3 min)

**Cr√©er le Provider:**
```tsx
// i18n/index.tsx
"use client";

import { createContext, useContext, useState, useEffect, ReactNode } from "react";

// Importer les traductions
import en from "./translations/en.json";
import fr from "./translations/fr.json";
import es from "./translations/es.json";

// Types
type Language = "en" | "fr" | "es";
type Translations = typeof en;

interface I18nContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
}

// Donn√©es
const translations: Record<Language, Translations> = { en, fr, es };

export const languageNames: Record<Language, string> = {
  en: "English",
  fr: "Fran√ßais",
  es: "Espa√±ol",
};

export const languageFlags: Record<Language, string> = {
  en: "üá¨üáß",
  fr: "üá´üá∑",
  es: "üá™üá∏",
};

export const availableLanguages: Language[] = ["en", "fr", "es"];

// Context
const I18nContext = createContext<I18nContextType | undefined>(undefined);
```

**√Ä dire:**
> "On importe les fichiers JSON directement. TypeScript nous donne l'autocompl√©tion gr√¢ce au `typeof en`."

---

### ‚è±Ô∏è 5:00 - 7:00 | Hook useTranslation (2 min)

**Compl√©ter le Provider:**
```tsx
// i18n/index.tsx (suite)

// Fonction pour acc√©der aux cl√©s imbriqu√©es
function getNestedValue(obj: unknown, path: string): string {
  const keys = path.split(".");
  let current = obj;

  for (const key of keys) {
    if (current && typeof current === "object" && key in current) {
      current = (current as Record<string, unknown>)[key];
    } else {
      return path; // Retourne la cl√© si non trouv√©e
    }
  }

  return typeof current === "string" ? current : path;
}

export function I18nProvider({ children }: { children: ReactNode }) {
  const [language, setLanguage] = useState<Language>("en");

  // Charger depuis localStorage
  useEffect(() => {
    const saved = localStorage.getItem("workshop-language") as Language;
    if (saved && availableLanguages.includes(saved)) {
      setLanguage(saved);
    }
  }, []);

  // Sauvegarder et mettre √† jour le HTML
  useEffect(() => {
    localStorage.setItem("workshop-language", language);
    document.documentElement.lang = language;
  }, [language]);

  // Fonction de traduction
  const t = (key: string): string => {
    return getNestedValue(translations[language], key);
  };

  return (
    <I18nContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </I18nContext.Provider>
  );
}

// Hook personnalis√©
export function useTranslation() {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error("useTranslation must be used within an I18nProvider");
  }
  return context;
}
```

**√Ä dire:**
> "La fonction `t()` prend une cl√© comme 'dashboard.title' et retourne la traduction. Si la cl√© n'existe pas, elle retourne la cl√© elle-m√™me - pratique pour d√©bugger!"

---

### ‚è±Ô∏è 7:00 - 10:00 | S√©lecteur de Langue (3 min)

**Utilisation dans un composant:**
```tsx
// Dans le Header ou Settings
"use client";
import { useTranslation, languageFlags, languageNames, availableLanguages } from "@/i18n";
import { Globe, ChevronDown } from "lucide-react";
import { useState } from "react";

function LanguageSelector() {
  const { language, setLanguage, t } = useTranslation();
  const [isOpen, setIsOpen] = useState(false);

  return (
    <div className="relative">
      {/* Bouton principal */}
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800"
      >
        <Globe className="w-4 h-4" />
        <span>{languageFlags[language]}</span>
        <ChevronDown className="w-4 h-4" />
      </button>

      {/* Dropdown */}
      {isOpen && (
        <div className="absolute right-0 mt-2 w-40 bg-white dark:bg-gray-800 rounded-lg shadow-lg border">
          {availableLanguages.map((lang) => (
            <button
              key={lang}
              onClick={() => {
                setLanguage(lang);
                setIsOpen(false);
              }}
              className={`w-full px-4 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2 ${
                language === lang ? "bg-purple-50 text-purple-600" : ""
              }`}
            >
              <span>{languageFlags[lang]}</span>
              <span>{languageNames[lang]}</span>
            </button>
          ))}
        </div>
      )}
    </div>
  );
}
```

**Utilisation de `t()` dans les pages:**
```tsx
// app/page.tsx
"use client";
import { useTranslation } from "@/i18n";

export default function Dashboard() {
  const { t } = useTranslation();

  return (
    <main>
      <h1>{t("dashboard.title")}</h1>
      
      <div className="grid grid-cols-4 gap-4">
        <StatCard title={t("dashboard.totalRevenue")} value="‚Ç¨45,890" />
        <StatCard title={t("dashboard.totalExpenses")} value="‚Ç¨12,340" />
        <StatCard title={t("dashboard.netIncome")} value="‚Ç¨33,550" />
        <StatCard title={t("dashboard.activeWorkers")} value="8" />
      </div>
    </main>
  );
}
```

**√Ä montrer:**
- Changer la langue via le s√©lecteur
- Voir tous les textes se mettre √† jour instantan√©ment
- Rafra√Æchir ‚Üí la langue est conserv√©e

**Conclusion:**
> "Notre app est maintenant multilingue! Chaque fois que vous ajoutez un nouveau texte, pensez √† l'ajouter dans les 3 fichiers JSON. Dans la prochaine vid√©o, on construit le dashboard avanc√©!"

---

## üìù Points Cl√©s √† Retenir

| Concept | Description |
|---------|-------------|
| **Fichiers JSON** | S√©parent le contenu du code |
| **Cl√©s imbriqu√©es** | `t("section.subsection.key")` |
| **localStorage** | Persiste le choix de langue |
| **languageFlags** | Emojis drapeaux pour l'UX |

---

## üéØ Exercice Pratique

1. Ajoutez le fichier `es.json` avec les traductions espagnoles
2. Ajoutez une nouvelle section "workers" dans les traductions
3. Cr√©ez un composant qui affiche "Bonjour" dans la langue s√©lectionn√©e

---

## ‚ö†Ô∏è Bonne Pratique

```tsx
// ‚úÖ BON - Cl√©s descriptives et organis√©es
t("dashboard.stats.totalRevenue")
t("workers.list.emptyState")
t("settings.theme.accentColor")

// ‚ùå MAUVAIS - Cl√©s plates et vagues
t("title")
t("button1")
t("text")
```

---

## ‚û°Ô∏è Vid√©o Suivante

[Vid√©o 05: Dashboard Avanc√©](./05-dashboard.md)
